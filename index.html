function Show-Gua ($yaos) {
    Write-Host "n🔻 你得到的卦象如下（由下至上）："
    for ($i = 5; $i -ge 0; $i--) {
        if ($yaos[$i] -eq 1) {
            Write-Host "———"  # 陽爻
        } else {
            Write-Host "— —"  # 陰爻
        }
    }
}

# 卦象解釋表（簡化示範）
$guaMap = @{
    "000000" = "坤卦（地）→ ❌ 不適合下海：柔順藏德，不宜輕舉妄動。"
    "000001" = "臨卦（地澤）→ ✅ 適合下海：上下和應，領導有方。"
    "000010" = "比卦（地水）→ ✅ 適合下海：團結合作，有利行動。"
    "000011" = "萃卦（地澤）→ ❌ 不適合下海：熱鬧但無實效。"
    "000100" = "剝卦（地山）→ ❌ 不適合下海：削弱破損，忌行動。"
    "000101" = "明夷卦（地火）→ ❌ 不適合下海：內明外暗，宜避險守靜。"
    "000110" = "升卦（地風）→ ❓ 視情況：穩步上升，非速成之道。"
    "000111" = "泰卦（地天）→ ❌ 不適合下海：雖順但易轉否。"
    "001000" = "屯卦（山雷）→ ✅ 適合下海：初難後通，宜啟程。"
    "001001" = "比卦（水澤）→ ❌ 不適合下海：依附他人，難有作為。"
    "001010" = "剝卦（山地）→ ❌ 不適合下海：削損凋零，危機重重。"
    "001011" = "謙卦（山澤）→ ❌ 不適合下海：宜守不宜攻。"
    "001100" = "艮卦（山）→ ❌ 不適合下海：靜止為安，動則有害。"
    "001101" = "損卦（山澤）→ ❌ 不適合下海：投入多，得少。"
    "001110" = "賁卦（山火）→ ❌ 不適合下海：外表華麗，實則虛浮。"
    "001111" = "夬卦（澤天）→ ✅ 適合下海：果斷前進，破難有成。"
    "010000" = "頤卦（山雷）→ ❌ 不適合下海：休養階段，非行動時。"
    "010001" = "屯卦（水雷）→ ❌ 不適合下海：困難重重，應暫避。"
    "010010" = "既濟卦（水火）→ ❌ 不適合下海：水滿則溢，忌貪多。"
    "010011" = "睽卦（火澤）→ ❓ 視情況：分歧多，難協調。"
    "010100" = "恒卦（雷風）→ ❓ 視情況：長久之計，宜穩重經營。"
    "010101" = "坎卦（水）→ ❓ 視情況：險中求勝，勿貿然行動。"
    "010110" = "觀卦（風地）→ ❌ 不適合下海：只宜觀察，暫勿投入。"
    "010111" = "需卦（水天）→ ✅ 適合下海：需中有成，耐心成功。"
    "011000" = "萃卦（澤地）→ ❌ 不適合下海：內聚不進，機會不足。"
    "011001" = "師卦（地水）→ ✅ 適合下海：軍隊之象，宜組隊謀事。"
    "011010" = "遯卦（天山）→ ❌ 不適合下海：避險為上，謙退之象。"
    "011011" = "渙卦（風澤）→ ❌ 不適合下海：離散瓦解，難聚財氣。"
    "011100" = "井卦（水風）→ ❌ 不適合下海：固守舊局，難以開創。"
    "011101" = "中孚卦（風澤）→ ❓ 視情況：誠信為本，可得人助。"
    "011110" = "漸卦（風山）→ ❓ 視情況：漸進之策，適合長期規劃。"
    "011111" = "升卦（地風）→ ❓ 視情況：步步高升，非速成之道。"
    "100000" = "無妄卦（天雷）→ ✅ 適合下海：直道而行，可避災得利。"
    "100001" = "同人卦（天火）→ ✅ 適合下海：志同道合，合力成事。"
    "100010" = "履卦（天澤）→ ❓ 視情況：謹慎踏實，戒急用忍。"
    "100011" = "家人卦（風火）→ ✅ 適合下海：家和萬事興，內外有序。"
    "100100" = "同人卦（天火）→ ✅ 適合下海：志同道合，合作有成。"
    "100101" = "旅卦（火天）→ ❓ 視情況：旅途風險與機會並存。"
    "100110" = "姤卦（天風）→ ✅ 適合下海：把握突發機會而動。"
    "100111" = "頤卦（雷火）→ ✅ 適合下海：開創新局，可進可退。"
    "101000" = "復卦（雷地）→ ✅ 適合下海：復甦之象，重新出發。"
    "101001" = "頤卦（山雷）→ ✅ 適合下海：養正蓄力，利謀略。"
    "101010" = "離卦（火）→ ❓ 視情況：華麗中藏險，需衡量風險。"
    "101011" = "益卦（風雷）→ ✅ 適合下海：得利可行，利於謀事。"
    "101100" = "豐卦（雷火）→ ❓ 視情況：榮華易逝，速得亦速失。"
    "101101" = "震卦（雷）→ ✅ 適合下海：動則有成，破局驚人。"
    "101110" = "歸妹卦（雷澤）→ ❓ 視情況：合作需謹慎，防分歧。"
    "101111" = "大壯卦（雷天）→ ✅ 適合下海：壯勢貫徹，但忌逞強。"
    "110000" = "損卦（山澤）→ ❌ 不適合下海：投入多，回報小。"
    "110001" = "巽卦（風）→ ❓ 視情況：行事飄忽，需穩定。"
    "110010" = "渙卦（風水）→ ✅ 適合下海：解困離險，可乘勢。"
    "110011" = "益卦（風雷）→ ❓ 視情況：利有攸往，需善用資源。"
    "110100" = "小過卦（風雷）→ ✅ 適合下海：小試身手可為。"
    "110101" = "解卦（雷水）→ ❓ 視情況：出險得救，但仍需慎行。"
    "110110" = "訟卦（水天）→ ❌ 不適合下海：訟爭風險高。"
    "110111" = "大過卦（澤風）→ ❓ 視情況：過猶不及，需節制。"
    "111000" = "否卦（天地）→ ❌ 不適合下海：否塞不通，時機未至。"
    "111001" = "大畜卦（天山）→ ✅ 適合下海：養精蓄銳，有後勢可圖。"
    "111010" = "小畜卦（風天）→ ❓ 視情況：勿貪快，小步前進可成。"
    "111011" = "夬卦（天澤）→ ✅ 適合下海：果斷前行，勇往直前。"
    "111100" = "小畜卦（風天）→ ❓ 視情況：蓄勢待發，不宜躁進。"
    "111101" = "大有卦（天火）→ ✅ 適合下海：實力雄厚，利爭利。"
    "111110" = "大壯卦（雷天）→ ✅ 適合下海：剛健進取。"
    "111111" = "乾卦（天）→ ✅ 適合下海：剛健自強，氣勢如虹。"
}

# 問是否要開始
$start = Read-Host "🔮 歡迎使用 PowerShell 八卦占卜機，是否要開始？(Y/N)"
if ($start -notin @("Y", "y")) {
    Write-Host "好的，祝你平安順利！"
    exit
}

do {
    Write-Host "n請靜心思考問題，正在擲卦……"
    Start-Sleep -Seconds 2

    # 生成 6 爻
    $yaos = @()
    for ($i = 0; $i -lt 6; $i++) {
        $yaos += Get-Random -Minimum 0 -Maximum 2
    }

    Show-Gua $yaos

    # 組合卦象
    $upper = "$($yaos[5])$($yaos[4])$($yaos[3])"
    $lower = "$($yaos[2])$($yaos[1])$($yaos[0])"
    $guaKey = $upper + $lower

    # 查詢解釋
    if ($guaMap.ContainsKey($guaKey)) {
        $result = $guaMap[$guaKey]
    } else {
        $result = "未知卦象，表示事情變化多端，請另擇良機。"
    }

    Write-Host "n🌟 你的卦象解釋："
    Write-Host $result

    # 是否重新占卜
    $again = Read-Host "n是否要重新占卜？(Y/N)"
} while ($again -in @("Y", "y"))

Write-Host "感謝使用 PowerShell 占卜機，祝你吉祥如意 🙏"